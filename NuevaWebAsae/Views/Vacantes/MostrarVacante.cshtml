@{
    Layout = "~/Views/Shared/_LayoutAdm.cshtml";
}
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css" />
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<style>
    table.dataTable thead th, table.dataTable thead td {
        padding: 10px 18px;
        border-bottom: 1px solid #fff;
    }

    .dataTables_wrapper.no-footer .dataTables_scrollBody {
        border-bottom: 1px solid #fff;
    }

    thead, tbody, tfoot, tr, td, th {
        border-color: inherit;
        border-style: none;
        border-width: 0;
    }

    .dataTables_wrapper .dataTables_length, .dataTables_wrapper .dataTables_filter, .dataTables_wrapper .dataTables_info, .dataTables_wrapper .dataTables_processing, .dataTables_wrapper .dataTables_paginate {
        color: #8392ab;
        FONT-SIZE: 10px;
    }

    .dataTable-wrapper .dataTable-bottom .dataTable-pagination .dataTable-pagination-list li a {
        display: flex;
        align-items: center;
        justify-content: center;
        color: #8392ab;
        padding: 0;
        margin: 0 3px;
        border: 1px solid #dee2e6;
        border-radius: 50% !important;
        width: 36px;
        height: 36px;
        font-size: .875rem;
        margin-left: 0;
    }



    .card-img-top {
        height: 250px;
    }

    .card-no-border .card {
        border-color: #d7dfe3;
        border-radius: 4px;
        margin-bottom: 30px;
        -webkit-box-shadow: 0px 5px 20px rgba(0, 0, 0, 0.05);
        box-shadow: 0px 5px 20px rgba(0, 0, 0, 0.05)
    }

    .card-body {
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        padding: 1.25rem
    }

    .pro-img {
        margin-top: -80px;
        margin-bottom: 20px
    }

    .little-profile .pro-img img {
        width: 128px;
        height: 128px;
        -webkit-box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 100%
    }

    .accordion-button:focus .titulovacante, .accordion-button[aria-expanded="true"] .titulovacante {
        background-color: #CB0B9F;
        color: white;
    }

</style>


<div class="container-fluid py-4">
    <div class="row">
        <div class="Vacante col-lg-7 col-md-7">
            <div class="row">
                <div class="col-md-12 mb-lg-0 mb-4">
                    <div id="barra2" class="card mt-4" style="height: 100vh; overflow-y: auto;">
                        <div class="card-header pb-0 p-3">
                            <div class="row">
                                <div class="col-10 align-items-center">
                                    <h6 class="mb-0"> @ViewBag.vacante.Titulo </h6>
                                    <i class="fa fa-map-marker" style="margin-right: 10px; color: #418CCB"></i><span>@ViewBag.vacante.ClienteDirecciones.Direccion</span>
                                </div>

                                <div class="col-2">
                                    <img src="~/images/jobctrl/asaelogo.png" style="width: 50%;" />
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-3" style="padding-top: 0px !important;">

                            <hr />

                            <div class="row">
                                <div class="col-12" style="margin-bottom:3%">
                                    <span style="border: 1px solid #D1E3F2; color: #313944; background-color: #fff; border-radius: 10px; padding: 1.5%; font-size: 74%; margin-right: 10px;">@ViewBag.vacante.Cat_Modalidad.Nombre</span>
                                    @if (@ViewBag.vacante.SalarioInicial == 0)
                                    {<span style="border: 1px solid #D1E3F2; color: #313944; background-color: #fff; border-radius: 10px; padding: 1.5%; font-size: 74%; margin-right: 10px;">Sueldo oculto</span>}
                                    else
                                    {<span style="border: 1px solid #D1E3F2; color: #313944; background-color: #fff; border-radius: 10px; padding: 1.5%; font-size: 74%; margin-right: 10px;">$@ViewBag.vacante.SalarioInicial a $@ViewBag.vacante.SalarioFinal</span>}
                                    <span style="border: 1px solid #D1E3F2; color: #313944; background-color: #fff; border-radius: 10px; padding: 1.5%; font-size: 74%; margin-right: 10px;">@ViewBag.vacante.Cat_EsquemaContratacion.Nombre</span>
                                    <i class="fa fa-clock-o" style="margin-right: 7px; color: #418CCB"></i><span style="font-size: 74%">@ViewBag.vacante.Cat_JornadaTrabajo.Nombre</span>
                                </div>
                                <div class="col-12" style="text-align:justify">

                                    @*Nav tabs*@
                                    <ul class="nav nav-tabs md-tabs" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" data-toggle="tab" href="#1" role="tab" aria-expanded="true">Listado prospectos</a>
                                            <div class="slide"></div>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#2" role="tab" aria-expanded="false">Información vacante</a>
                                            <div class="slide"></div>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" data-toggle="tab" href="#" role="tab" aria-expanded="false" onclick="variante(@ViewBag.vacante.Id)">Crear Nuevo Puesto Similar </a>
                                            <div class="slide"></div>
                                        </li>
                                    </ul>
                                    @*Tab panes*@
                                    <div class="tab-content card-block">
                                        <div class="tab-pane active" id="1" role="tabpanel" aria-expanded="true">
                                            <div class="row">
                                                <div class="col-md-12" id="">
                                                    <div class="demo-inline-spacing mt-3">
                                                        <div class="list-group">
                                                            <p></p>
                                                            <div class="table-responsive">
                                                                <table class="table align-items-center mb-0 table-hover " id="TableListaProspectos" width="100%">
                                                                    <thead>
                                                                        <tr>
                                                                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Nombre </th>
                                                                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Correo</th>
                                                                            <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Mostrar</th>

                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        @{
                                                                            if (ViewBag.Prospecto != null)
                                                                            {
                                                                                foreach (var item1 in ViewBag.Prospecto)
                                                                                {
                                                                                    <tr class="border card-plain  border-radius-lg " style="border: 1px solid #dee2e6 !important;">
                                                                                        <td class="text-center">
                                                                                            <span class="text-xs">@item1.Nombre </span>
                                                                                        </td>
                                                                                        <td class="text-center">
                                                                                            <span class="text-xs">@item1.CorreElectronico </span>
                                                                                        </td>

                                                                                        <td class="text-center">
                                                                                            <i style="cursor:pointer; font-size:16px;" onclick="VerProspecto(@item1.Id)" class="fa fa-address-card-o" aria-hidden="true"></i>
                                                                                        </td>
                                                                                    </tr>
                                                                                }
                                                                            }
                                                                        }

                                                                    </tbody>
                                                                </table>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>



                                        <div class="tab-pane" id="2" role="tabpanel" aria-expanded="false">
                                            <div class="row">
                                                <div class="col-md-12" id="">
                                                    <div class="demo-inline-spacing mt-3">
                                                        <div class="list-group">

                                                            @Html.Raw(ViewBag.vacante.Contenido);

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <p style="font-size:75%">Fecha de publicación: @ViewBag.vacante.FechaRegistro</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="col-lg-5 col-md-5">
            <div class="col-md-12">
                <!-- Column -->
                <div class="card mt-4" style="height: 100vh; overflow-y: auto;">
                    <img class="card-img-top" src="~/images/fondo.jpg" alt="Card image cap">
                    <div class="card-body little-profile text-center">
                        <div class="pro-img"><img src="~/images/jobctrl/Profile.png" alt="user"></div>
                        <h3 id="Nombre" class="m-b-0">Nombre del prospecto </h3>
                        <p id="Apellidos"></p> <a href="javascript:void(0)" class="m-t-10 waves-effect waves-dark btn btn-primary btn-md btn-rounded mb-3" data-abc="true">Contacto</a>

                        <div class="row text-center m-t-20">
                            <div class="col-lg-7 col-md-7 m-t-20">
                                <i class="fa fa-envelope-o" style="margin-right: 7px; color: #418CCB; font-size: 130%"></i><span class="m-b-0 font-light" style="font-size: 120%">Correo</span>
                                <p id="Correo"></p>
                            </div>
                            <div class="col-lg-5 col-md-5 m-t-20">
                                <i class="fa fa-mobile" style="margin-right: 7px; color: #418CCB; font-size:130%"></i><span class="m-b-0 font-light" style="font-size: 120%">Telefono</span>

                                <p id="Telefono"></p>
                            </div>
                            <div class="row">
                                <div class="col-lg-12" id="DivListPDF">

                                </div>
                            </div>


                            <div class="card-body pb-0">
                                <div class="row">
                                    <h5>Experiencia laboral</h5>
                                    <div class="col-md-12 col-lg-12" id="ListaEmpleos">

                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="row text-center m-t-20">
                            <h5>Notas</h5>
                            <span id="Notas" style="border: 1px solid #D1E3F2; color: #313944; background-color: #fff; border-radius: 10px; padding: 1.5%; font-size: 74%; margin-right: 10px;">Selecciona una vacante  para obtener su información</span>

                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="row">

        <div class="col-xl-12 col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5>Bitacora de actividades</h5>
                    <span class="text-muted">Historial de movimientos en la vacante.</span>

                </div>
                <div class="card-block">
                    <div class="row">
                        <div class="col-md-6"></div>


                        <div class="col-lg-12 col-xl-12">
                            @*Nav tabs*@
                            <ul class="nav nav-tabs md-tabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#home3" role="tab" aria-expanded="true">Actividad</a>
                                    <div class="slide"></div>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#profile3" role="tab" aria-expanded="false">Notas</a>
                                    <div class="slide"></div>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#profile4" role="tab" aria-expanded="false">Entrevistas  </a>
                                    <div class="slide"></div>
                                </li>
                            </ul>
                            @*Tab panes*@
                            <div class="tab-content card-block">
                                <div class="tab-pane active" id="home3" role="tabpanel" aria-expanded="true">
                                    <div class="row">
                                        <div class="col-md-12" id="">
                                            <div class="demo-inline-spacing mt-3">
                                                <div class="list-group">

                                                    @{
                                                        if (ViewBag.Bitacora != null)
                                                        {
                                                            foreach (var item in ViewBag.Bitacora)
                                                            {
                                                                if (item.Cat_Operacion.Nombre == "PROSPECTO REGISTRADO" & item.Usuarios.Personas.Nombre == "ROGELIO")
                                                                {
                                                                    <a href="javascript:void(0);" class="list-group-item list-group-item-action flex-column align-items-start">
                                                                        <div class="d-flex justify-content-between w-100">
                                                                            <h6>@item.Cat_Operacion.Nombre</h6>
                                                                            <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro).ToString("dd-MM-yyyy")</small>
                                                                        </div>

                                                                        <p class="mb-1">
                                                                            <strong>Nuevo prospecto registrado desde la pagina web asae</strong>  @Html.Raw(item.Nota)
                                                                        </p>
                                                                        <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro)</small>
                                                                    </a>
                                                                }
                                                                else
                                                                {
                                                                    <a href="javascript:void(0);" class="list-group-item list-group-item-action flex-column align-items-start">
                                                                        <div class="d-flex justify-content-between w-100">
                                                                            <h6>@item.Cat_Operacion.Nombre</h6>
                                                                            <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro).ToString("dd-MM-yyyy")</small>
                                                                        </div>

                                                                        <p class="mb-1">
                                                                            <strong>@item.Usuarios.Personas.Nombre @item.Usuarios.Personas.ApPaterno @item.Usuarios.Personas.ApMaterno</strong>  @Html.Raw(item.Nota)
                                                                        </p>
                                                                        <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro)</small>
                                                                    </a>
                                                                }
                                                            }
                                                        }
                                                    }

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="profile3" role="tabpanel" aria-expanded="false">
                                    <div class="row">
                                        <div class="col-md-12" id="">
                                            <div class="demo-inline-spacing mt-3">
                                                <div class="list-group">

                                                    @{
                                                        if (ViewBag.VacanteNota != null)
                                                        {
                                                            foreach (var item in ViewBag.VacanteNota)
                                                            {
                                                                <a href="javascript:void(0);" class="list-group-item list-group-item-action flex-column align-items-start">
                                                                    <div class="d-flex justify-content-between w-100">
                                                                        <h6>Nota registrada</h6>
                                                                        <i onclick="Editarnota('@item.Id', '@item.Nota')" class="fa fa-pencil-square-o" title="Editar nota"></i>
                                                                    </div>

                                                                    <p class="mb-1">
                                                                        Propietario: <strong>@item.Usuarios.Personas.Nombre @item.Usuarios.Personas.ApPaterno @item.Usuarios.Personas.ApMaterno</strong> <br /> Nota: <br />  @Html.Raw(item.Nota)
                                                                    </p>
                                                                    <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro)</small>
                                                                </a>
                                                            }
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="profile4" role="tabpanel" aria-expanded="false">
                                    <div class="row">
                                        <div class="col-md-12" id="">
                                            <div class="demo-inline-spacing mt-3">
                                                <div class="list-group">

                                                    @{
                                                        if (ViewBag.Entrevistas != null)
                                                        {
                                                            foreach (var item in ViewBag.Entrevistas)
                                                            {
                                                                <a href="javascript:void(0);" class="list-group-item list-group-item-action flex-column align-items-start">
                                                                    <div class="d-flex justify-content-between w-100">
                                                                        <h6>Entrevista registrada</h6>
                                                                       <i onclick="EditarEntrevista('@item.Id', '@item.Observaciones')" class="fa fa-pencil-square-o" title="Editar nota"></i>
                                                                    </div>

                                                                    <p class="mb-1">
                                                                        Propietario: <strong>@item.Usuarios.Personas.Nombre @item.Usuarios.Personas.ApPaterno @item.Usuarios.Personas.ApMaterno</strong>
                                                                        <br />
                                                                        Contacto: @item.Prospecto.Nombre  @item.Prospecto.ApellidoPaterno  @item.Prospecto.ApellidoMaterno
                                                                        <br />
                                                                        Entrevisto:
                                                                        @if (item.Responsable == 1)
                                                                        {
                                                                            <strong>Responsable -  @item.VacanteResponsable.Nombre </strong>
                                                                        }
                                                                        else
                                                                        {
                                                                            <strong> Propietario de la vacante </strong>
                                                                        }
                                                                        <br />
                                                                        Fecha Entrevista: @Convert.ToDateTime(item.FechaEntrevista).ToString("dd-MM-yyyy")
                                                                        <br /> Observaciones : <br />  @Html.Raw(item.Observaciones)
                                                                    </p>
                                                                    <small class="text-muted">@Convert.ToDateTime(item.FechaRegistro)</small>
                                                                </a>
                                                            }
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

</div>

    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="ModalPDF" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Archivo </h5>
                <button type="button" class="btn-close text-dark" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <iframe id="iframepdf" width="100%" height="400px;" frameborder="0"></iframe>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"> Cancelar</button>
            </div>
        </div>
    </div>
</div>


<script src="~/Scripts/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>


<script>
    $(document).ready(function () {
        $('#Dashboard').addClass("nav-link active");
    });

    $(document).ready(function () {
        var tabla = $('#TableListaProspectos').DataTable({
            scrollY: 350,
            scrollX: true,
            "language": {
                "url": "//cdn.datatables.net/plug-ins/1.10.15/i18n/Spanish.json"
            },
            "pageLength": 10,
        });
    });

    function VerProspecto(Id) {
        var obj = {};
        obj['Id'] = Id;

        var jsonObject = {
            "prospecto": obj
        };

        $.ajax({
            url: "@Url.Action("Prospectos_Listar_Id", "Vacantes")",
            data: JSON.stringify(jsonObject),
            type: "POST",
            contentType: "application/json",
            dataType: "json",

            success: function (resultado) {
                $('#Nombre').text(resultado.Nombre);
                $('#Apellidos').text(resultado.ApellidoPaterno);
                $('#Correo').text(resultado.CorreElectronico);
                $('#Telefono').text(resultado.TelefonoCelular);
                $('#Notas').html(resultado.Observaciones);


                if (resultado.ProspectoArchivo === null) {
                    $("#DivListPDF").empty();
                } else {
                    MostrarCV(resultado);
                }

                $("#ListaEmpleos").empty();
                CargaExperiencia(Id);
            },
            error: function (resultado) {
                alert("Error de ejecucion ");
            }
        });
    }

    function CargaExperiencia(Id) {
        var obj = {};
        obj['Id'] = Id;

        var jsonObject = {
            "prospectoExperiencia": obj
        };
        $.ajax({
            type: "POST",
            url: "@Url.Action("ProspectoExperiencia_Listar_Id", "ProspectoExperiencia")",
            async: false,
            data: JSON.stringify(jsonObject),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (result) {
                var Table = "<div class='timeline timeline-one-side'> ";

                for (var b = 0; b < result.length; b++) {

                    Table += "<div class='timeline-block mb-3'>" +
                        "<span class='timeline-step'>" +
                        "<i class='ni ni-briefcase-24 text-primary text-gradient'></i>" +
                        "</span>" +
                        "<div class='timeline-content'>" +
                        "<h6 class='text-dark text-sm font-weight-bold mb-0'>" + result[b].Cargo + "</h6>" +
                        "<h6 class='text-dark text-sm font-weight-bold mb-0'>" + result[b].NombreEmpresa + "</h6>";

                    if (result[b].TrabajoActivo == 1) {
                        Table += "<p class='text-secondary font-weight-bold text-xs mt-1 mb-0'>" + FormatoDefecha(result[b].FechaInicio) + "- Actualmente trabajo aquí </p>";
                    } else {
                        Table += "<p class='text-secondary font-weight-bold text-xs mt-1 mb-0'>" + FormatoDefecha(result[b].FechaInicio) + " - " + FormatoDefecha(result[b].FechaTermino) + " </p>";
                    }
                    Table += "</div>" +
                        "</div>";
                }
                Table += "</div>";

                $("#ListaEmpleos").html(Table);
            },
            error: function () {

            }
        });
    }


    function MostrarCV(A) {

        var Table = "<ul class='list-group'>" +
            "<li class='list-group-item border-0 d-flex align-items-center px-0 mb-2'>" +
            "<div class='avatar me-3'>";
        if (A.ProspectoArchivo.Extencion == '.pdf') {
            Table += "<img src='../images/ImgPdf.png' class='border-radius-lg shadow'>";
        } else {
            Table += "<img src='../images/ImgWork.jpg' class='border-radius-lg shadow'>";
        }
        Table += "</div>" +
            "<div class='d-flex align-items-start flex-column justify-content-center'>" +
            "<h6 class='mb-0 text-sm'>Curriculum vitae.</h6>" +
            "<p class='mb-0 text-xs'>" + A.ProspectoArchivo.NmOriginal + "</p>" +
            "</div>";
        if (A.ProspectoArchivo.Extencion == '.pdf') {
            Table += "<a class='btn btn-link pe-3 ps-0 mb-0 ms-auto' onclick='MostrarPDF(" + JSON.stringify(A) + ")'>Mostrar</a>";
        } else {
            Table += "<a class='btn btn-link pe-3 ps-0 mb-0 ms-auto' onclick='DescargarArchivo(" + JSON.stringify(A) + ")'>Descargar</a>";
        }
        Table += "" +
            "</li>" +
            "</ul>";

        $("#DivListPDF").html(Table);
    }

    function MostrarPDF(INF) {
        /*console.log(INF);*/

        var ProspectoArchivo = new Object();
        ProspectoArchivo.Id = INF.ProspectoArchivo.Id;

        $.ajax({
            type: "POST",
            url: "@Url.Action("ProspectoArchivo_Seleccionar_Id", "ProspectoArchivo")",
            async: false,
            data: JSON.stringify(ProspectoArchivo),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                console.log(data);

                var mail = "";
                if (data.Referencia == 1) {
                    var mail = "https://rechumanos.asae.com.mx/DocumentosTemporales/" + data.NmArchivo;
                } else {
                    var mail = "https://www.asae.com.mx/PDF/Prospectos/" + data.NmArchivo;
                }
              /*  alert(data.NmArchivo);*/
                $('#iframepdf').attr('src', mail);
            },
            error: function () {

            }
        });
        $("#ModalPDF").modal("show");


        @*console.log(INF);

        var obj = {};
        obj['NmArchivo'] = INF.ProspectoArchivo.NmArchivo;
        obj['NmOriginal'] = INF.ProspectoArchivo.NmOriginal;

        var jsonObject = {
            "prospectoArchivo": obj
        };

        $.ajax({
            url: "@Url.Action("ProspectoArchivo_Consultar_Listas", "ProspectoArchivo")",
            data: JSON.stringify(jsonObject),
            type: "POST",
            contentType: "application/json",
            dataType: "json",

            success: function (data) {
                var mail = "https://" + data.NmArchivo;
                $('#iframepdf').attr('src', mail);

            },
            error: function (data) {
                alert("Error de ejecucion ");
            }
        });
        $("#ModalPDF").modal("show");*@


    }

    function DescargarArchivo(INF) {
        var ProspectoArchivo = new Object();
        ProspectoArchivo.Id = INF.ProspectoArchivo.Id;

        $.ajax({
            type: "POST",
            url: "@Url.Action("ProspectoArchivo_Seleccionar_Id", "ProspectoArchivo")",
            async: false,
            data: JSON.stringify(ProspectoArchivo),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {

                var pdfUrl = "";
                if (data.Referencia == 1) {
                    var pdfUrl = "https://rechumanos.asae.com.mx/DocumentosTemporales/" + data.NmArchivo;
                } else {
                    var pdfUrl = "https://www.asae.com.mx/PDF/Prospectos/" + data.NmArchivo;
                }

                var link = document.createElement('a');
                link.href = pdfUrl;
                link.download = data.NmArchivo; // Nombre del archivo
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

            },
            error: function () {

            }
        });

        @*console.log(INF);
        var obj = {};
        obj['NmArchivo'] = INF.ProspectoArchivo.NmArchivo;
        obj['NmOriginal'] = INF.ProspectoArchivo.NmOriginal;

        var jsonObject = {
            "prospectoArchivo": obj
        };

        $.ajax({
            url: "@Url.Action("ProspectoArchivo_Consultar_Listas", "ProspectoArchivo")",
            data: JSON.stringify(jsonObject),
            type: "POST",
            contentType: "application/json",
            dataType: "json",

            success: function (data) {
                var pdfUrl = "https://" + data.NmArchivo;

                var link = document.createElement('a');
                link.href = pdfUrl;
                link.download = data.NmOriginal;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

            },
            error: function (data) {
                alert("Error de ejecucion ");
            }
        });*@

    }

    function FormatoDefecha(fechaEnFormatoJSON) {

        var FormatoDecha = "";

        // Extraer el número de milisegundos de la cadena utilizando una expresión regular
        var milisegundos = parseInt(fechaEnFormatoJSON.match(/\d+/)[0]);

        // Crear un objeto de fecha a partir de los milisegundos
        var fecha = new Date(milisegundos);

        // Obtener el día, mes y año
        var dia = fecha.getDate();
        var mes = fecha.getMonth() + 1; // Los meses comienzan desde 0, así que sumamos 1
        var año = fecha.getFullYear();

        // Formatear la fecha como "dd-MM-yyyy"
        var fechaFormateada = ('0' + dia).slice(-2) + '-' + ('0' + mes).slice(-2) + '-' + año;

        FormatoDecha = fechaFormateada;

        return FormatoDecha;
    }

    function Editarnota(id, nota) {
        swal({
            title: 'Editar Nota',
            text: 'Introduce el nuevo texto de la nota:',
            content: {
                element: 'textarea',
                attributes: {
                    placeholder: 'Escribe alguna nota referente a la vacante',
                    value: nota,
                },
            },
            buttons: {
                cancel: {
                    text: 'Cancelar',
                    visible: true,
                },
                confirm: {
                    text: 'Guardar',
                    value: 'save',
                },
            },
            closeOnClickOutside: false,
        }).then((value) => {
            if (value === 'save') {
                const nuevaNota = document.querySelector('textarea').value;
                if (nuevaNota.trim() === '') {
                    swal('Campo vacío', 'Es necesario escribir algo antes de guardar.', 'error')
                        .then(() => {
                            Editarnota(id, nota);
                        });
                } else {
                    var VacanteNota = new Object();
                    var Vacante = new Object();
                    Vacante.Id =@ViewBag.Vacante.Id;

                    VacanteNota.Id = id;
                    VacanteNota.Nota = nuevaNota;
                    VacanteNota.Vacante = Vacante;

                     $.ajax({
                        type: "POST",
                        url: "@Url.Action("Vacante_Actualizar_nota", "Vacantes")",
                        async: false,
                         data: JSON.stringify(VacanteNota),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                         success: function (result) {
                             swal({
                                 title: "Nota Actualizada",
                                 text: "La nota ha sido actualizada correctamente.",
                                 icon: "success",
                                 buttons: {
                                     confirm: {
                                         text: "Aceptar",
                                         className: "btn-primary",
                                         closeModal: false
                                     }
                                 }
                             }).then(() => {
                                 location.reload();
                             });
                         },
                        error: function () {
                            swal({
                                title: "Problemas en la solicitud",
                                text: "Vacante no actualizada !",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            }).then((willDelete) => {

                            });
                        }
                    });

                }
            }
        });
    }

    function variante(Id) {
 var obj = {};

            obj['UrlVaible'] = Id;

            var jsonObject = {
                "URL": obj
            };

            $.ajax({
                type: "POST",
                url: "@Url.Action("URL_Cifrar", "URLS")",
                async: false,
                data: JSON.stringify(jsonObject),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    window.location.href = '@Url.Action("NewWork", "Vacantes")?IdS=' + result.Url;

                },
                error: function () {
                    AlertDanger("Problemas al consultar ", "Intentolo mas tarde.");
                }
            });
    }

    function EditarEntrevista(id, observaciones) {

        swal({
            title: 'Editar Entrevista',
            text: 'Escribe la nueva observación:',
            content: {
                element: 'textarea',
                attributes: {
                    placeholder: 'Escribe alguna observación referente a la vacante',
                    value: observaciones,
                },
            },
            buttons: {
                cancel: {
                    text: 'Cancelar',
                    visible: true,
                },
                confirm: {
                    text: 'Guardar',
                    value: 'save',
                },
            },
            closeOnClickOutside: false,
        }).then((value) => {
            if (value === 'save') {
                const nuevaObservacion = document.querySelector('textarea').value;
                if (nuevaObservacion.trim() === '') {
                    swal('Campo vacío', 'Es necesario escribir algo antes de guardar.', 'error')
                        .then(() => {
                            EditarEntrevista(id, observaciones);
                        });
                } else {
                    var VacanteNota = new Object();
                    var Vacante = new Object();
                    Vacante.Id =@ViewBag.Vacante.Id;

                    VacanteNota.Id = id;
                    VacanteNota.Nota = nuevaObservacion;
                    VacanteNota.Vacante = Vacante;

                     $.ajax({
                        type: "POST",
                        url: "@Url.Action("Vacante_Actualizar_entrevista", "Vacantes")",
                        async: false,
                         data: JSON.stringify(VacanteNota),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                         success: function (result) {
                             swal({
                                 title: "Entrevista Actualizada",
                                 text: "La entrevista ha sido actualizada correctamente.",
                                 icon: "success",
                                 buttons: {
                                     confirm: {
                                         text: "Aceptar",
                                         className: "btn-primary",
                                         closeModal: false
                                     }
                                 }
                             }).then(() => {
                                 location.reload();
                             });
                         },
                        error: function () {
                            swal({
                                title: "Problemas en la solicitud",
                                text: "Vacante no actualizada !",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            }).then((willDelete) => {

                            });
                        }
                    });

                }
            }
        });
    }
</script>
